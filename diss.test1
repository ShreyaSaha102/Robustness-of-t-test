
rm(list=ls())

set.seed(1234)
#normal

R=1000
X=replicate(R,rnorm(20,1,1))     #mu=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

X=replicate(R,rnorm(20,2,1))   #mu=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power

a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)
#==============================================================================

#set.seed(1234)
#exponential

R=1000
X=replicate(R,rexp(20,1))    #rate=mean=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

R=1000
X=replicate(R,rexp(20,0.5))  #rate=0.5, mean=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power


a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)
#==============================================================================

#set.seed(1234)
#unif

R=1000
X=replicate(R,runif(20,0,2))   #a=0,b=2 ;mean=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

X=replicate(R,runif(20,0,4))   #a=0,b=4  ;mean=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power


a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)
#==============================================================================

#rm(list=ls())
#set.seed(1234)
#gamma

R=1000
X=replicate(R,rgamma(20,scale=0.5,shape=2))  #alpha=2,p=2 ;mean=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

R=1000
X=replicate(R,rgamma(20,scale=1,shape=2))   #alpha=1,p=2 ;mean=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power

a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)
#==============================================================================

#set.seed(1234)
#cauchy

R=1000
X=replicate(R,rcauchy(20,scale=1,location=1))  #mu=median=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

R=1000
X=replicate(R,rcauchy(20,scale=1,location=2))   #mu=median=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power

a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)
#===============================================================================

#set.seed(1234)
#logistic

R=1000
X=replicate(R,rlogis(20,1,1))       #location=mean=1
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s1=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s1)
crit=qt(0.95,19)
crit
size=mean(ifelse(T>crit,1,0))
size

R=1000
X=replicate(R,rlogis(20,location=2,scale=1))    #location=mean=2
M=matrix(X,ncol=20,byrow=T)
m=apply(M,1,mean)
s=apply(M,1,sd)
T=(m-1)*(sqrt(20)/s)
crit=qt(0.95,19)
crit
power=mean(ifelse(T>crit,1,0))
power

a=1+(qt(0.95,19)*(mean(s1)/sqrt(20)));a
mean(s1)

#==============================================================================
level=c(0.048,0.022,0.056,0.02,0.034,0.047)
power=c(0.995,0.811,0.986,0.983,0.282,0.784)
distn=c("normal","exp","unif","gamma","cauchy","logistic")
d1=data.frame(distn,level,power)
d1

